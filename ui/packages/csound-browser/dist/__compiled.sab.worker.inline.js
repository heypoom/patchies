export default () =>
  (window.URL || window.webkitURL).createObjectURL(
    new Blob([
      '(function(){/*\n\n Copyright The Closure Library Authors.\n SPDX-License-Identifier: Apache-2.0\n*/\nvar m,r=this||self;function u(a,b){a=a.split(".");var c=r;a[0]in c||"undefined"==typeof c.execScript||c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)a.length||void 0===b?c[d]&&c[d]!==Object.prototype[d]?c=c[d]:c=c[d]={}:c[d]=b}function C(a,b){F.prototype[a]=b};const aa=Symbol("Comlink.proxy"),ba=Symbol("Comlink.endpoint"),ca=Symbol("Comlink.releaseProxy"),da=Symbol("Comlink.thrown"),ea=a=>"object"==typeof a&&null!==a||"function"==typeof a,ja=new Map([["proxy",{M:a=>ea(a)&&a[aa],V(a){const {port1:b,port2:c}=new MessageChannel;return fa(a,b),[c,[c]]},N:a=>(a.start(),ha(a))}],["throw",{M:a=>ea(a)&&da in a,V({value:a}){let b;return b=a instanceof Error?{R:!0,value:{message:a.message,name:a.name,stack:a.stack}}:{R:!1,value:a},[b,[]]},N(a){if(a.R)throw Object.assign(Error(a.value.message),\na.value);throw a.value;}}]]);\nfunction fa(a,b=self){b.addEventListener("message",function e(d){if(d&&d.data){var g=d.data.argumentList,{id:h,type:f,path:k}=Object.assign({path:[]},d.data);g=(g||[]).map(I);try{const n=k.slice(0,-1).reduce((p,t)=>p[t],a),q=k.reduce((p,t)=>p[t],a);switch(f){case "GET":var l=q;break;case "SET":n[k.slice(-1)[0]]=I(d.data.value);l=!0;break;case "APPLY":l=q.apply(n,g);break;case "CONSTRUCT":l=Object.assign(new q(...g),{[aa]:!0});break;case "ENDPOINT":const {port1:p,port2:t}=new MessageChannel;fa(a,t);\nl=ka(p,[p]);break;case "RELEASE":l=void 0;break;default:return}}catch(n){l={value:n,[da]:0}}Promise.resolve(l).catch(n=>({value:n,[da]:0})).then(n=>{const [q,p]=la(n);n={...q};n.id=h;b.postMessage(n,p);"RELEASE"===f&&(b.removeEventListener("message",e),ma(b))})}});b.start&&b.start()}function ma(a){"MessagePort"===a.constructor.name&&a.close()}\nfunction ha(a){return function g(c,d=[],e=function(){}){let h=!1;const f=new Proxy(e,{get(k,l){if(na(h),l===ca)return()=>J(c,{type:"RELEASE",path:d.map(n=>n.toString())}).then(()=>{ma(c);h=!0});if("then"===l){if(0===d.length)return{then:()=>f};k=J(c,{type:"GET",path:d.map(n=>n.toString())}).then(I);return k.then.bind(k)}return g(c,[...d,l])},set(k,l,n){na(h);const [q,p]=la(n);return J(c,{type:"SET",path:[...d,l].map(t=>t.toString()),value:q},p).then(I)},apply(k,l,n){na(h);k=d[d.length-1];if(k===ba)return J(c,\n{type:"ENDPOINT"}).then(I);if("bind"===k)return g(c,d.slice(0,-1));const [q,p]=oa(n);n={type:"APPLY"};n.path=d.map(t=>t.toString());n.argumentList=q;return J(c,n,p).then(I)},construct(k,l){na(h);const [n,q]=oa(l);k={type:"CONSTRUCT"};k.path=d.map(p=>p.toString());k.argumentList=n;return J(c,k,q).then(I)}});return f}(a,[],void 0)}function na(a){if(a)throw Error("Proxy has been released and is not useable");}\nfunction oa(a){a=a.map(la);const b=(c=a.map(d=>d[1]),Array.prototype.concat.apply([],c));return[a.map(d=>d[0]),b];var c}const qa=new WeakMap;function ka(a,b){return qa.set(a,b),a}function la(a){for(const [b,c]of ja)if(c.M(a)){const [d,e]=c.V(a);return[{type:"HANDLER",name:b,value:d},e]}return[{type:"RAW",value:a},qa.get(a)||[]]}function I(a){switch(a.type){case "HANDLER":return ja.get(a.name).N(a.value);case "RAW":return a.value}}\nfunction J(a,b,c){return new Promise(d=>{const e=Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");a.addEventListener("message",function f(h){h.data&&h.data.id&&h.data.id===e&&(a.removeEventListener("message",f),d(h.data))});a.start&&a.start();b.id=e;a.postMessage(b,c)})};function K(){}K.prototype.g=!1;K.prototype.port=void 0;K.prototype.G=()=>{};K.prototype.o=()=>{};const ra=a=>()=>a.exports.csoundCreateWasi();ra.toString=()=>"create = async () => undefined;";const sa=a=>b=>a.exports.csoundDestroy(b);sa.toString=()=>"destroy = async () => undefined;";const ta=a=>()=>a.exports.csoundGetAPIVersion();ta.toString=()=>"getAPIVersion = async () => Number;";const ua=a=>()=>a.exports.csoundGetVersion();ua.toString=()=>"getVersion = async () => Number;";const va=a=>(b,c)=>a.exports.csoundInitialize(c);va.toString=()=>"initialize = async () => Number;";const M=new TextDecoder("utf8"),wa=new TextEncoder("utf8");const N=a=>{const b=a.indexOf("\\x00");return-1<b?a.substr(0,b):a};const Q=(a,b)=>{a.exports.freeStringMem(b)},R=(a,b)=>{if("string"!==typeof b)console.error("Expected string but got",typeof b);else{b=wa.encode(b);var c=a.exports.allocStringMem(b.length);(new Uint8Array(a.i.memory.buffer,c,b.length+1)).set(b);return c}};const xa=a=>(b,c)=>{c=R(a,c);b=a.exports.csoundParseOrc(b,c);Q(a,c);return b};xa.toString=()=>"parseOrc = async (orchestra) => Object;";const ya=a=>(b,c)=>a.exports.csoundCompileTree(b,c);ya.toString=()=>"compileTree = async (tree) => Number;";const za=a=>(b,c)=>{c=R(a,c);b=a.exports.csoundCompileOrc(b,c);Q(a,c);return b};za.toString=()=>"compileOrc = async (orchestra) => Number;";const Aa=a=>(b,c)=>{c=R(a,c);b=a.exports.csoundEvalCode(b,c);Q(a,c);return b};Aa.toString=()=>"csoundEvalCode = async (orchestra) => Number;";\nconst Ba=a=>b=>a.exports.csoundStartWasi(b);Ba.toString=()=>"start = async () => Number;";const Ca=a=>(b,c,d=1)=>{c=R(a,c);b=a.exports.csoundCompileCSD(b,c,d,0);Q(a,c);return b};Ca.toString=()=>"compileCSD = async (csoundDocument) => Number;";const Da=a=>b=>a.exports.csoundPerformKsmpsWasi(b);Da.toString=()=>"performKsmps = async (csound) => Number;";const Ea=()=>()=>{};Ea.toString=()=>"stop = async () => undefined;";const Fa=a=>b=>a.exports.csoundResetWasi(b);Fa.toString=()=>"reset = async () => Number;";const Ga=[["device_name","char",64],["interface_name","char",64],["device_id","char",64],["midi_module","char",64],["isOutput","int"]],Ha=[["type","int"],["lexme","ptr"],["value","int"],["fvalue","double"],["optype","ptr"],["next","ptr"]],Ia=[["type","int"],["value","ptr"],["rate","int"],["len","int"],["line","int"],["locn","uint64"],["left","ptr"],["right","ptr"],["next","ptr"],["markup","ptr"]];const Ja={ob:4,Db:8,Wa:8,char:1,lb:8,yb:4,Eb:8},Ka=a=>a?a.reduce((b,[,c])=>Ja[c]?Ja[c]+b:Ka({Ya:Ia,Xa:Ha}[c])+b,0):0;Ka(Ia);Ka(Ha);\nKa([["debug_mode","int"],["buffer_frames","int"],["hardware_buffer_frames","int"],["displays","int"],["ascii_graphs","int"],["postscript_graphs","int"],["message_level","int"],["tempo","int"],["ring_bell","int"],["use_cscore","int"],["terminate_on_midi","int"],["heartbeat","int"],["defer_gen01_load","int"],["midi_key","int"],["midi_key_cps","int"],["midi_key_oct","int"],["midi_key_pch","int"],["midi_velocity","int"],["midi_velocity_amp","int"],["no_default_paths","int"],["number_of_threads","int"],\n["syntax_check_only","int"],["csd_line_counts","int"],["compute_weights","int"],["realtime_mode","int"],["sample_accurate","int"],["sample_rate_override","MYFLT"],["control_rate_override","MYFLT"],["nchnls_override","int"],["nchnls_i_override","int"],["e0dbfs_override","MYFLT"],["daemon","int"],["ksmps_override","int"],["FFT_library","int"]]);const La=Ka(Ga);const Ma=a=>{const [b]=Ga.reduce(([c,d],[e,g,...h])=>{h="char"===g?Ja[g]*h[0]:Ja[g];g="char"===g?N(M.decode(a.subarray(d,h)))||"":a[d];c[e]=g;return[c,d+h]},[{},0]);return b};const Na=a=>b=>a.exports.csoundGetSr(b);Na.toString=()=>"getSr = async () => Number;";const Oa=a=>(b,c)=>a.exports.csoundSystemSr(b,c);Oa.toString=()=>"systemSr = async (val) => Number;";const Pa=a=>b=>a.exports.csoundGetKr(b);Pa.toString=()=>"getKr = async () => Number;";const Qa=a=>b=>a.exports.csoundGetKsmps(b);Qa.toString=()=>"getKsmps = async () => Number;";Qa.toString=()=>"getChannels = async (isInput) => Number;";const Sa=a=>b=>a.exports.csoundGetChannels(b,0);Sa.toString=()=>"getNchnls = async () => Number;";\nconst Ta=a=>b=>a.exports.csoundGetChannels(b,1);Ta.toString=()=>"getNchnlsInput = async () => Number;";const Ua=a=>b=>a.exports.csoundGet0dBFS(b);Ua.toString=()=>"get0dBFS = async () => Number;";const Va=a=>b=>a.exports.csoundGetA4(b);Va.toString=()=>"getA4 = async () => Number;";const Wa=a=>b=>a.exports.csoundGetCurrentTimeSamples(b);Wa.toString=()=>"getCurrentTimeSamples = async () => Number;";const Xa=a=>b=>a.exports.csoundGetSizeOfMYFLT(b);Xa.toString=()=>"getSizeOfMYFLT = async () => Number;";\nconst Ya=a=>(b,c)=>{c=R(a,c);b=a.exports.csoundSetOption(b,c);Q(a,c);return b};Ya.toString=()=>"setOption = async (option) => Number;";const Za=a=>b=>a.exports.csoundGetDebug(b);Za.toString=()=>"getDebug = async () => Number;";const $a=a=>(b,c)=>{a.exports.csoundSetDebug(b,c)};$a.toString=()=>"setDebug = async (number) => undefined;";const ab=a=>b=>a.exports.csoundGetSpin(b);ab.toString=()=>"getSpin = async (csound) => Number;";const bb=a=>b=>a.exports.csoundGetSpout(b);bb.toString=()=>"getSpout = async () => Number;";const cb=a=>{const b=[];for(let c=0;c<a;c++)b.push(c);return b};const db=a=>(b,c)=>{const d=a.i.memory.buffer,e=a.exports.csoundGetMIDIDevList(b,void 0,c?1:0);if(0===e)return[];const g=a.exports.allocCsMidiDeviceStruct(e);a.exports.csoundGetMIDIDevList(b,g,c?1:0);const h=new Uint8Array(d,g,La*e);b=cb(e).map(f=>Ma(h.subarray(f*La,La)));a.exports.freeCsMidiDeviceStruct(g);return b};db.toString=()=>"getMIDIDevList = async (isOutput) => Object;";const eb=a=>b=>{var c=a.i.memory.buffer;b=a.exports.getRtMidiName(b);c=new Uint8Array(c,b,128);return N(M.decode(c))||""};\neb.toString=()=>"getRtMidiName = async () => String;";const fb=a=>(b,c,d,e)=>{a.exports.pushMidiMessage(b,c,d,e)};fb.toString=()=>"midiMessage = async (status, data1, data2) => undefined;";const gb=a=>(b,c)=>{c=R(a,c);b=a.exports.csoundEventString(b,c,0);Q(a,c);return b};gb.toString=()=>"inputMessage = async (scoreEvent) => Number;";const hb=a=>(b,c)=>{c=R(a,c);b=a.exports.csoundEventString(b,c,1);Q(a,c);return b};hb.toString=()=>"inputMessageAsync = async (scoreEvent) => Number;";const ib=a=>(b,c)=>{c=R(a,c);b=a.exports.csoundGetControlChannelWasi(b,c);Q(a,c);return b};ib.toString=()=>"getControlChannel = async (channelName) => Number;";\nconst jb=a=>(b,c,d)=>{c=R(a,c);a.exports.csoundSetControlChannel(b,c,d);Q(a,c)};jb.toString=()=>"setControlChannel = async (channelName, value) => void;";const kb=a=>(b,c)=>{c=R(a,c);b=a.exports.csoundGetStringChannelWasi(b,c);var d=new Uint8Array(a.i.memory.buffer,b);d=M.decode(d);d=N(d);Q(a,c);Q(a,b);return d};kb.toString=()=>"getStringChannel = async (channelName) => String;";const lb=a=>(b,c,d)=>{c=R(a,c);d=R(a,d);a.exports.csoundSetStringChannel(b,c,d);Q(a,c);Q(a,d)};lb.toString=()=>"setStringChannel = async (channelName, value) => void;";const mb=a=>b=>{var c=a.i.memory.buffer;b=a.exports.csoundGetOutputName(b);c=new Uint8Array(c,b,64);return N(M.decode(c))||""};mb.toString=()=>"getOutputName = async () => String;";const nb=a=>b=>{var c=a.i.memory.buffer;b=a.exports.csoundGetInputName(b);c=new Uint8Array(c,b,64);return N(M.decode(c))||""};nb.toString=()=>"getInputName = async (csound) => String;";const ob=a=>(b,c,d)=>{c=R(a,c);d=R(a,d);b=a.exports.csoundAppendEnv(b,c,d);Q(a,c);Q(a,d);return b};ob.toString=()=>"appendEnv = async (csound, variable, value) => Number;";const pb=a=>b=>a.exports.csoundIsScorePending(b);pb.toString=()=>"isScorePending = async () => Number;";const qb=a=>(b,c)=>a.exports.csoundSetScorePending(b,c);qb.toString=()=>"setScorePending = async (pending) => Number;";const rb=a=>(b,c)=>{c=R(a,c);b=a.exports.csoundEventString(b,c,0);Q(a,c);return b};rb.toString=()=>"readScore = async (score) => Number;";const sb=a=>b=>a.exports.csoundGetScoreTime(b);sb.toString=()=>"getScoreTime = async () => Number;";const tb=a=>b=>a.exports.csoundGetScoreOffsetSeconds(b);\ntb.toString=()=>"getScoreOffsetSeconds = async () => Number;";const ub=a=>(b,c)=>a.exports.csoundSetScoreOffsetSeconds(b,c);ub.toString=()=>"setScoreOffsetSeconds = async () => Number;";const vb=a=>b=>a.exports.csoundRewindScore(b);vb.toString=()=>"rewindScore = async () => undefined;";const wb=a=>(b,c)=>a.exports.csoundTableLength(b,c);wb.toString=()=>"tableLength = async (tableNum) => Number;";const xb=a=>(b,c,d)=>{const e=a.exports.allocFloatArray(d.length);(new Float64Array(a.i.memory.buffer,e,d.length)).set(d);a.exports.csoundTableCopyIn(b,c,e);a.exports.freeFloatArrayMem(e)};xb.toString=()=>"tableCopyIn = async (tableNum, float64Array) => undefined;";\nconst yb=a=>(b,c)=>{var d=a.exports.csoundTableLength(b,c);if(0<d){const e=a.exports.allocFloatArray(d);a.exports.csoundTableCopyOut(b,c,e);b=new Float64Array(a.i.memory.buffer,e,d);c=new Float64Array(b.length);for(d=0;d<b.length;d++)c[d]=b[d];a.exports.freeFloatArrayMem(e);return c}};yb.toString=()=>"tableCopyOut = async (tableNum) => ?Float64Array;";yb.toString=yb.toString;\nconst zb=a=>(b,c)=>{const d=a.exports.allocFloatArray(1024);a.exports.csoundGetTableArgs(b,d,c);b=new Float64Array(a.i.memory.buffer,d,1024);a.exports.freeFloatArrayMem(d);return b};zb.toString=()=>"getTableArgs = async (tableNum) => ?Float64Array;";function Ab(a){return(b,c,d)=>{b="string"===typeof d?wa.encode(d):d;a.i.writeFile(c,b)}}u("writeFile$$module$src$filesystem$worker_fs",Ab);Ab.toString=()=>"async (path, data) => void";function Bb(a){return(b,c,d)=>{b="string"===typeof d?wa.encode(d):d;a.i.appendFile(c,b)}}u("appendFile$$module$src$filesystem$worker_fs",Bb);Bb.toString=()=>"async (path, data) => void";function Cb(a){return(b,c)=>a.i.readFile(c)}u("readFile$$module$src$filesystem$worker_fs",Cb);Cb.toString=()=>"async (path) => ?Uint8Array";\nfunction Db(a){return(b,c)=>a.i.unlink(c)}u("unlink$$module$src$filesystem$worker_fs",Db);Db.toString=()=>"async (path) => void";function Eb(a){return(b,c)=>a.i.readdir(c)}u("readdir$$module$src$filesystem$worker_fs",Eb);Eb.toString=()=>"async (path) => string[]";function Fb(a){return(b,c)=>a.i.mkdir(c)}u("mkdir$$module$src$filesystem$worker_fs",Fb);Fb.toString=()=>"async (path) => void";function Gb(a){return(b,c)=>a.i.stat(c)}u("stat$$module$src$filesystem$worker_fs",Gb);Gb.toString=()=>"async (path) => ?object";\nfunction Hb(a){return(b,c)=>Ib(a.i,c)}u("pathExists$$module$src$filesystem$worker_fs",Hb);Hb.toString=()=>"async (path) => boolean";function Jb(a){return(b,c)=>Kb(a.i,c)}u("chdir$$module$src$filesystem$worker_fs",Jb);Jb.toString=()=>"async (path) => number";function Lb(a){return()=>a.i.cwd}u("getcwd$$module$src$filesystem$worker_fs",Lb);Lb.toString=()=>"async () => string";const S={};S.writeFile=Ab;S.appendFile=Bb;S.readFile=Cb;S.unlink=Db;S.readdir=Eb;S.mkdir=Fb;S.stat=Gb;S.pathExists=Hb;\nS.chdir=Jb;S.getcwd=Lb;const Mb={csoundCreate:ra,csoundDestroy:sa,csoundGetAPIVersion:ta,csoundGetVersion:ua,csoundInitialize:va,csoundParseOrc:xa,csoundCompileTree:ya,csoundCompileOrc:za,csoundEvalCode:Aa,csoundStart:Ba,csoundCompileCSD:Ca,csoundPerformKsmps:Da,csoundStop:Ea,csoundReset:Fa,csoundGetSr:Na,gb:Oa,csoundGetKr:Pa,csoundGetKsmps:Qa,csoundGetNchnls:Sa,csoundGetNchnlsInput:Ta,eb:a=>(b,c)=>a.exports.csoundGetChannels(b,c),csoundGet0dBFS:Ua,csoundGetA4:Va,csoundGetCurrentTimeSamples:Wa,csoundGetSizeOfMYFLT:Xa,csoundSetOption:Ya,\ncsoundGetDebug:Za,csoundSetDebug:$a,csoundGetSpin:ab,csoundGetSpout:bb,csoundGetMIDIDevList:db,csoundSetMidiCallbacks:a=>b=>{a.exports.csoundSetMidiCallbacks(b)},csoundGetRtMidiName:eb,csoundGetMidiOutFileName:a=>b=>{var c=a.i.memory.buffer;b=a.exports.getMidiOutFileName(b);c=new Uint8Array(c,b,128);b&&0<b.length&&Q(a,b);return N(M.decode(c))||""},csoundPushMidiMessage:fb,_isRequestingRtMidiInput:a=>b=>a.exports.isRequestingRtMidiInput(b),csoundInputMessage:gb,csoundInputMessageAsync:hb,csoundGetControlChannel:ib,\ncsoundSetControlChannel:jb,csoundGetStringChannel:kb,csoundSetStringChannel:lb,csoundGetInputName:nb,csoundGetOutputName:mb,csoundAppendEnv:ob,csoundShouldDaemonize:a=>b=>a.exports.csoundShouldDaemonize(b),csoundIsScorePending:pb,csoundSetScorePending:qb,csoundReadScore:rb,csoundGetScoreTime:sb,csoundGetScoreOffsetSeconds:tb,csoundSetScoreOffsetSeconds:ub,csoundRewindScore:vb,csoundTableLength:wb,csoundTableCopyIn:xb,csoundTableCopyOut:yb,csoundGetTable:yb,csoundGetTableArgs:zb,fs:S};\nfunction Nb(a){const {fs:b,...c}=Mb;return{...Object.keys(c).reduce((d,e)=>{d[e]=c[e](a);return d},{}),...Object.keys(b).reduce((d,e)=>{d[e]=b[e](a);return d},{})}};void 0!==r&&(r={});r.BigInt||(r.BigInt=void 0===BigInt?Number:BigInt);const Ob=r.BigInt(1)|r.BigInt(2)|r.BigInt(4)|r.BigInt(8)|r.BigInt(16)|r.BigInt(32)|r.BigInt(64)|r.BigInt(128)|r.BigInt(256)|r.BigInt(2097152)|r.BigInt(4194304)|r.BigInt(8388608)|r.BigInt(134217728),Pb=r.BigInt(0);function Qb(a){let b=arguments[0];for(let d=1;d<arguments.length;d++){const e=arguments[d];if(0==e.lastIndexOf("/",0))b=e;else{var c;(c=""==b)||(c=b.length-1,c=0<=c&&b.indexOf("/",c)==c);c?b+=e:b+="/"+e}}return b};function Rb(a){return a?a.split("/").filter(b=>0<b.length&&"."!==b):[]}function Sb(a){if(!a)return"/";const b=[];Rb(a).forEach(c=>{".."===c?0<b.length&&b.pop():b.push(c)});return 0<b.length?`/${b.join("/")}`:"/"}function T(a,b){if(!b||"."===b)return Sb(a||"/");if(/^\\//.test(b))return Sb(b);a=Rb(a||"/");b=b.split("/");const c=[...a];b.forEach(d=>{d&&"."!==d&&(".."===d?0<c.length&&c.pop():c.push(d))});return 0<c.length?`/${c.join("/")}`:"/"}\nfunction Tb(){return"undefined"===typeof performance||"undefined"===typeof performance.now?Date.now()-Date.now():performance.now()}function Ub(a){var b=a.reduce((d,e)=>d+e.length,0);if(0!==a.length){b=new Uint8Array(b);var c=0;for(const d of a)b.set(d,c),c+=d.length;return b}}\nfunction F(){var {T:a}={T:{"/":"/"}};this.fd=Array.from({length:4});this.fd[0]={fd:0,path:"/dev/stdin",seekPos:r.BigInt(0),buffers:[]};this.fd[1]={fd:1,path:"/dev/stdout",seekPos:r.BigInt(0),buffers:[]};this.fd[2]={fd:2,path:"/dev/stderr",seekPos:r.BigInt(0),buffers:[]};this.fd[3]={fd:3,path:"/",seekPos:r.BigInt(0),buffers:[],type:"dir"};this.h=this.h.bind(this);this.g=0;this.cwd="/";this.T=a||{}}F.prototype.start=function(a){this.g=Tb();a.exports._start()};\nfunction Vb(a,b){const c={};b=WebAssembly.Module.imports(b);for(const d of b)"function"===d.kind&&d.module.startsWith("wasi_")&&("object"!==typeof c[d.module]&&(c[d.module]={}),c[d.module][d.name]=a[d.name].bind(a));return c}F.prototype.h=function(){this.view&&this.view.buffer&&this.view.buffer.byteLength||(this.view=new DataView(this.memory.buffer));return this.view};function Wb(a,b){b=Sb(b);a=Object.values(a.fd);for(const c of a)if(c&&c.path===b)return c;return null}\nfunction Kb(a,b){b=Sb(T(a.cwd,b));if("/"===b)return a.cwd="/",a.fd[3]&&(a.fd[3].path="/",a.fd[3].type="dir"),0;const c=Wb(a,b);if(!c)return 44;if(c.type&&"dir"!==c.type)return 54;a.cwd=b;a.fd[3]&&(a.fd[3].path=b,a.fd[3].type="dir");return 0}function Xb(a){const b=Math.trunc(a);return r.BigInt(b)*r.BigInt(1E6)+r.BigInt(Math.round(1E6*(a-b)))}function Yb(a,b){switch(b){case 1:return Math.floor(Tb());case 0:return Xb(Date.now());case 2:case 3:return Math.floor(Tb()-a.g);default:return 0}}\nF.prototype.aa=function(){return 0};C("args_get",F.prototype.aa);F.prototype.ba=function(){return 0};C("args_sizes_get",F.prototype.ba);F.prototype.ca=function(){return 0};C("clock_res_get",F.prototype.ca);F.prototype.da=function(a,b,c){this.h().setBigUint64(c,r.BigInt(Yb(this,a)),!0);return 0};C("clock_time_get",F.prototype.da);F.prototype.ea=function(){return 0};C("environ_get",F.prototype.ea);F.prototype.fa=function(){return 0};C("environ_sizes_get",F.prototype.fa);F.prototype.ga=function(){return 52};\nC("fd_advise",F.prototype.ga);F.prototype.ha=function(){return 52};C("fd_allocate",F.prototype.ha);F.prototype.ia=function(){return 0};C("fd_close",F.prototype.ia);F.prototype.ja=function(){return 0};C("fd_datasync",F.prototype.ja);F.prototype.ka=function(a,b){a=this.h();a.setUint8(b+4,4);a.setUint16(b+2,0,!0);a.setUint16(b+4,0,!0);a.setBigUint64(b+8,r.BigInt(Ob),!0);a.setBigUint64(b+8+8,r.BigInt(Pb),!0);return 0};C("fd_fdstat_get",F.prototype.ka);F.prototype.la=function(){return 52};\nC("fd_fdstat_set_flags",F.prototype.la);F.prototype.ma=function(){return 0};C("fd_fdstat_set_rights",F.prototype.ma);\nF.prototype.na=function(a,b){let c=0;this.fd[a]&&(c=this.fd[a].buffers.reduce(function(e,g){return e+(null==g?void 0:g.byteLength)?null==g?void 0:g.byteLength:0},0));const d=this.h();d.setBigUint64(b,r.BigInt(a),!0);b+=8;d.setBigUint64(b,r.BigInt(a),!0);b+=8;d.setUint8(b,4);b+=8;d.setBigUint64(b,r.BigInt(1),!0);b+=8;d.setBigUint64(b,r.BigInt(c),!0);b+=8;d.setBigUint64(b,Xb(this.g),!0);b+=8;d.setBigUint64(b,Xb(this.g),!0);d.setBigUint64(b+8,Xb(this.g),!0);return 0};C("fd_filestat_get",F.prototype.na);\nF.prototype.oa=function(){return 0};C("fd_filestat_set_size",F.prototype.oa);F.prototype.pa=function(){return 0};C("fd_filestat_set_times",F.prototype.pa);F.prototype.qa=function(){return 0};C("fd_pread",F.prototype.qa);F.prototype.ra=function(a,b){if(!this.fd[a]&&!this.fd[a-1])return 8;var {path:c}=this.fd[a];a=this.h();c=wa.encode(c);(new Uint8Array(a.buffer)).set(c,b);return 0};C("fd_prestat_dir_name",F.prototype.ra);\nF.prototype.sa=function(a,b){if(!this.fd[a])return 8;var {path:c}=this.fd[a];a=this.h();c=wa.encode(c);a.setUint8(b,0);a.setUint32(b+4,c.byteLength,!0);return 0};C("fd_prestat_get",F.prototype.sa);F.prototype.ta=function(a,b,c,d,e){console.log("fd_pwrite",a,b,c,d,e,arguments);return 0};C("fd_pwrite",F.prototype.ta);\nF.prototype.ua=function(a,b,c,d){const e=this.h();a=this.fd[a];if(!a||!Array.isArray(a.buffers))return e.setUint32(d,0,!0),8;const g=a.buffers;if(0===g.length)return e.setUint32(d,0,!0),a.seekPos=r.BigInt(0),0;var h=g.reduce((q,p)=>q+p.length,0);let f=Number(a.seekPos),k=0,l=!1;if(f>=h)return b=e.getUint32(b,!0),e.setUint8(b,0),e.setUint32(d,0,!0),0;for(h=0;h<c;h++){var n=b+8*h;const q=e.getUint32(n,!0);n=e.getUint32(n+4,!0);l||(k+=n,Array.from({length:n},(p,t)=>t).reduce((p,t)=>{if(l)return p;const [y,\nL]=p;let A=p=0,x=!1,v=0,H;if(0===t)for(;!x;)H=g[p]?g[p].byteLength:0,v<=f&&H+v>f?(x=!0,A=f-v):(v+=H,p+=1);else p=y,A=L;g[p]?(e.setUint8(q+t,g[p][A]),A+1>=g[p].byteLength?(p=y+1,A=0):A+=1):(e.setUint8(q+t,0),f+=t,l=!0);return[p,A]},[0,0]),l||(f+=n))}a.seekPos=r.BigInt(f);e.setUint32(d,k,!0);return 0};C("fd_read",F.prototype.ua);F.prototype.va=function(){return 0};C("fd_readdir",F.prototype.va);F.prototype.wa=function(){return 0};C("fd_renumber",F.prototype.wa);\nF.prototype.xa=function(a,b,c,d){const e=this.h();switch(c){case 1:let g;this.fd[a].seekPos=(null!=(g=this.fd[a].seekPos)?g:r.BigInt(0))+r.BigInt(b);break;case 2:c=(this.fd[a].buffers||[]).reduce((h,f)=>h+f.length,0);this.fd[a].seekPos=BigInt(c)+BigInt(b);break;case 0:this.fd[a].seekPos=BigInt(b)}e.setBigUint64(d,this.fd[a].seekPos,!0);return 0};C("fd_seek",F.prototype.xa);F.prototype.ya=function(){return 0};C("fd_sync",F.prototype.ya);\nF.prototype.za=function(a,b){const c=this.h();this.fd[a].seekPos||(this.fd[a].seekPos=r.BigInt(0));c.setBigUint64(b,this.fd[a].seekPos,!0);return 0};C("fd_tell",F.prototype.za);\nF.prototype.Aa=function(a,b,c,d){let e=!1;const g=this.h();this.fd[a].buffers=this.fd[a].buffers||[];this.fd[a].seekPos===r.BigInt(0)&&0<this.fd[a].buffers.length&&(e=!0);let h=0;for(let l=0;l<c;l++){var f=b+8*l,k=g.getUint32(f,!0);f=g.getUint32(f+4,!0);h+=f;k=new Uint8Array(g.buffer,k,f);e?this.fd[a].buffers.unshift(k.slice(0,f)):this.fd[a].buffers.push(k.slice(0,f))}this.fd[a].seekPos+=r.BigInt(h);g.setUint32(d,h,!0);[1,2].includes(a)&&console.log(M.decode(Ub(this.fd[a].buffers)));return 0};\nC("fd_write",F.prototype.Aa);F.prototype.Ba=function(){return 0};C("path_create_directory",F.prototype.Ba);F.prototype.Ca=function(){return 0};C("path_filestat_get",F.prototype.Ca);F.prototype.Da=function(){return 0};C("path_filestat_set_times",F.prototype.Da);F.prototype.Ea=function(){return 0};C("path_link",F.prototype.Ea);\nF.prototype.Fa=function(a,b,c,d,e,g,h,f,k){b=this.h();g=(this.fd[a]||{path:this.cwd}).path;c=new Uint8Array(b.buffer,c,d);c=M.decode(c);let l;3===a?l=T(this.cwd,c):l=Sb(Qb(g,c));if(l.startsWith("/..")||"/._"===l||"/.AppleDouble"===l)return 8;a=0!==(e&2);d=0!==(e&1);if((c=Wb(this,l))&&"dir"===c.type&&!a)return 31;if(!c&&a)return 44;if(!c&&!d&&!a)return b.setUint32(k,4294967295,!0),44;d=c?c.fd:this.fd.length;c||void 0!==this.fd[d]||(this.fd[d]={fd:d});c=c||this.fd[d]||{fd:d};this.fd[d]={...c,fd:d,path:l,\ntype:a?"dir":c.type||"file",seekPos:r.BigInt(0),buffers:Array.isArray(c.buffers)?c.buffers:[]};0===(e&8)||a||(this.fd[d].buffers.length=0);b.setUint32(k,d,!0);return 0};C("path_open",F.prototype.Fa);F.prototype.Ga=function(){return 0};C("path_readlink",F.prototype.Ga);F.prototype.Ha=function(){return 0};C("path_remove_directory",F.prototype.Ha);F.prototype.Ia=function(){return 0};C("path_rename",F.prototype.Ia);F.prototype.Ja=function(){return 0};C("path_symlink",F.prototype.Ja);F.prototype.Ka=function(){return 0};\nC("path_unlink_file",F.prototype.Ka);F.prototype.La=function(){return 0};C("poll_oneoff",F.prototype.La);F.prototype.Ma=function(){return 0};C("proc_exit",F.prototype.Ma);F.prototype.Na=function(){return 0};C("proc_raise",F.prototype.Na);F.prototype.Oa=function(){return 0};C("random_get",F.prototype.Oa);F.prototype.Pa=function(){return 0};C("sched_yield",F.prototype.Pa);F.prototype.Qa=function(){return 52};C("sock_recv",F.prototype.Qa);F.prototype.Ra=function(){return 52};C("sock_send",F.prototype.Ra);\nF.prototype.Sa=function(){return 52};C("sock_shutdown",F.prototype.Sa);function Zb(a,b){return(a=Object.values(a.fd).find(({path:c})=>c===b))&&a.buffers}m=F.prototype;m.readdir=function(a){a=T(this.cwd,a);const b="/"===a?"/":`${a}/`,c=[];Object.values(this.fd).forEach(d=>{if(d&&d.path&&(d=d.path,d.startsWith(b))){var e=d.slice(b.length);0!==e.length&&(/\\//g.test(e)||c.push(d))}});return c.map(d=>d.replace(b,"").replace(/^\\//g,"")).filter(d=>!!d)};\nm.writeFile=function(a,b){const c=T(this.cwd,a);a=Object.keys(this.fd).length;const d=Object.values(this.fd).find(({path:e})=>e===c);this.fd[a]={fd:a,path:c,seekPos:r.BigInt(0),buffers:[b],type:"file"};d&&delete this.fd[d]};m.appendFile=function(a,b){var c=T(this.cwd,a);(c=Zb(this,c))?c.push(b):console.error(`Can\'t append to non-existing file ${a}`)};m.readFile=function(a){a=T(this.cwd,a);if(a=Zb(this,a))return Ub(a)};\nm.unlink=function(a){const b=T(this.cwd,a);(a=Object.values(this.fd).find(({path:c})=>c===b))?delete this.fd[a.fd]:console.error(`While trying to unlink ${b}, path not found`)};m.mkdir=function(a){const b=T(this.cwd,a),c=[];Object.values(this.fd).forEach(({path:d})=>d.startsWith(b)&&c.push(d));0<c.length?console.warn(`mkdir: path ${a} already exists`):(a=Object.keys(this.fd).length,this.fd[a]={fd:a,path:b,type:"dir"})};\nm.stat=function(a){const b=T(this.cwd,a);if(a=Object.values(this.fd).find(({path:e})=>e===b)){var c=(a.buffers||[]).reduce((e,g)=>e+((null==g?void 0:g.byteLength)||0),0),d="dir"===a.type;return{kb:0,nb:a.fd,mode:d?16877:33188,xb:1,uid:0,mb:0,zb:0,size:c,cb:4096,A:Math.ceil(c/512),$a:this.g,vb:this.g,jb:this.g,bb:this.g,Za:new Date(this.g),ub:new Date(this.g),ib:new Date(this.g),ab:new Date(this.g),isFile:!d,isDirectory:d,pb:!1,qb:!1,tb:!1,rb:!1,sb:!1}}};\nfunction Ib(a,b){const c=T(a.cwd,b);return!!Object.values(a.fd).find(({path:d})=>d===c)};function $b(a){for(;0<a.length;)a.pop()};let V,ac,bc;V=()=>()=>{};ac=()=>()=>{};bc=()=>{};/*\n zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License */\nfunction cc(a){const b=a.length;let c=0,d=Number.POSITIVE_INFINITY,e,g,h,f;let k,l;for(k=0;k<b;++k)a[k]>c&&(c=a[k]),a[k]<d&&(d=a[k]);const n=1<<c,q=new Uint32Array(n);e=1;g=0;for(h=2;e<=c;){for(k=0;k<b;++k)if(a[k]===e){f=0;var p=g;for(l=0;l<e;++l)f=f<<1|p&1,p>>=1;p=e<<16|k;for(l=f;l<n;l+=h)q[l]=p;++g}++e;g<<=1;h<<=1}return[q,c,d]};function dc(a,b){this.A=[];this.bufferSize=32768;this.l=this.v=this.j=this.F=0;this.u=new Uint8Array(a);this.U=!1;this.m=W;this.resize=!1;if(b||!(b={}))b.index&&(this.j=b.index),b.bufferSize&&(this.bufferSize=b.bufferSize),b.m&&(this.m=b.m),b.resize&&(this.resize=b.resize);switch(this.m){case ec:this.g=32768;this.h=new Uint8Array(this.bufferSize+33026);break;case W:this.g=0;this.h=new Uint8Array(this.bufferSize);break;default:throw Error("invalid inflate mode");}}\nvar ec=0,W=1,fc=new Uint16Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),gc=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]),hc=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]),ic=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]),jc=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),\nkc;const lc=new Uint8Array(288);let X,mc;X=0;for(mc=lc.length;X<mc;++X)lc[X]=143>=X?8:255>=X?9:279>=X?7:8;kc=cc(lc);var nc;const oc=new Uint8Array(30);let pc,qc;pc=0;for(qc=oc.length;pc<qc;++pc)oc[pc]=5;nc=cc(oc);function Z(a,b){let c=a.v,d=a.l;const e=a.u;let g=a.j;if(g+(b-d+7>>3)>=e.length)throw Error("input buffer is broken");for(;d<b;)c|=e[g++]<<d,d+=8;a.v=c>>>b;a.l=d-b;a.j=g;return c&(1<<b)-1}\nfunction rc(a,b){let c=a.v,d=a.l;var e=a.u;let g=a.j;var h=e.length;const f=b[0];for(b=b[1];d<b&&!(g>=h);)c|=e[g++]<<d,d+=8;e=f[c&(1<<b)-1];h=e>>>16;if(h>d)throw Error("invalid code length: "+h);a.v=c>>h;a.l=d-h;a.j=g;return e&65535}\nfunction sc(a,b,c){let d=a.h,e=a.g;a.Y=b;const g=d.length-258;var h;let f,k;for(;256!==(h=rc(a,b));)if(256>h)e>=g&&(a.g=e,d=tc(a),e=a.g),d[e++]=h;else for(h-=257,k=gc[h],0<hc[h]&&(k+=Z(a,hc[h])),h=rc(a,c),f=ic[h],0<jc[h]&&(f+=Z(a,jc[h])),e>=g&&(a.g=e,d=tc(a),e=a.g);k--;)d[e]=d[e++-f];for(;8<=a.l;)a.l-=8,a.j--;a.g=e}\nfunction uc(a,b,c){let d=a.h,e=a.g;a.Y=b;let g=d.length;var h;let f,k;for(;256!==(h=rc(a,b));)if(256>h)e>=g&&(d=vc(a),g=d.length),d[e++]=h;else for(h-=257,k=gc[h],0<hc[h]&&(k+=Z(a,hc[h])),h=rc(a,c),f=ic[h],0<jc[h]&&(f+=Z(a,jc[h])),e+k>g&&(d=vc(a),g=d.length);k--;)d[e]=d[e++-f];for(;8<=a.l;)a.l-=8,a.j--;a.g=e}function tc(a){const b=new Uint8Array(a.g-32768),c=a.g-32768,d=a.h;b.set(d.subarray(32768,b.length));a.A.push(b);a.F+=b.length;d.set(d.subarray(c,c+32768));a.g=32768;return d}\nfunction vc(a,b){let c=Math.trunc(a.u.length/a.j+1);const d=a.u,e=a.h;b&&("number"===typeof b.O&&(c=b.O),"number"===typeof b.$&&(c+=b.$));2>c?(b=(d.length-a.j)/a.Y[2],b=Math.trunc(b/2*258),b=b<e.length?e.length+b:e.length<<1):b=e.length*c;b=new Uint8Array(b);b.set(e);a.h=b;return a.h};function wc(a){var b;this.j=a;this.g=0;if(b||!(b={}))b.index&&(this.g=b.index),b.verify&&(this.verify=b.verify);const c=a[this.g++],d=a[this.g++];switch(c&15){case 8:this.method=8;break;default:throw Error("unsupported compression method");}if(0!==((c<<8)+d)%31)throw Error("invalid fcheck flag:"+((c<<8)+d)%31);if(d&32)throw Error("fdict flag is not supported");this.h=new dc(a,{index:this.g,bufferSize:b.bufferSize,m:b.m,resize:b.resize})}\nfunction xc(a){var b=a.j,c;a:{for(c=a.h;!c.U;){var d=void 0,e=void 0,g=void 0,h=void 0,f=c,k=Z(f,3);k&1&&(f.U=!0);k>>>=1;switch(k){case 0:k=f.u;e=f.j;var l=f.h,n=f.g;g=k.length;d=l.length;f.v=0;f.l=0;if(e+1>=g)throw Error("invalid uncompressed block header: LEN");h=k[e++]|k[e++]<<8;if(e+1>=g)throw Error("invalid uncompressed block header: NLEN");g=k[e++]|k[e++]<<8;if(h===~g)throw Error("invalid uncompressed block header: length verify");if(e+h>k.length)throw Error("input buffer is broken");switch(f.m){case ec:for(;n+\nh>l.length;)g=d-n,h-=g,l.set(k.subarray(e,e+g),n),n+=g,e+=g,f.g=n,l=tc(f),n=f.g;break;case W:for(;n+h>l.length;)l=vc(f,{O:2});break;default:throw Error("invalid inflate mode");}l.set(k.subarray(e,e+h),n);f.j=e+h;f.g=n+h;f.h=l;break;case 1:switch(f.m){case W:uc(f,kc,nc);break;case ec:sc(f,kc,nc);break;default:throw Error("invalid inflate mode");}break;case 2:k=Z(f,5)+257;d=Z(f,5)+1;l=Z(f,4)+4;n=new Uint8Array(fc.length);for(e=0;e<l;++e)n[fc[e]]=Z(f,3);n=cc(n);l=new Uint8Array(k+d);e=0;for(d=k+d;e<\nd;)switch(g=rc(f,n),g){case 16:for(g=3+Z(f,2);g--;)l[e++]=h;break;case 17:for(g=3+Z(f,3);g--;)l[e++]=0;h=0;break;case 18:for(g=11+Z(f,7);g--;)l[e++]=0;h=0;break;default:h=l[e++]=g}h=cc(l.subarray(0,k));k=cc(l.subarray(k));switch(f.m){case W:uc(f,h,k);break;case ec:sc(f,h,k);break;default:throw Error("invalid inflate mode");}break;default:throw Error("unknown BTYPE: "+k);}}switch(c.m){case ec:{f=0;h=c.h;k=c.A;l=new Uint8Array(c.F+(c.g-32768));let q;if(0===k.length)c=c.h.subarray(32768,c.g);else{n=\n0;for(d=k.length;n<d;++n)for(e=k[n],g=0,q=e.length;g<q;++g)l[f++]=e[g];n=32768;for(d=c.g;n<d;++n)l[f++]=h[n];c.A=[];c.buffer=l;c=c.buffer}}break a;case W:h=c.g;c.resize?(f=new Uint8Array(h),f.set(c.h.subarray(0,h))):f=c.h.subarray(0,h);c.buffer=f;c=c.buffer;break a;default:throw Error("invalid inflate mode");}}a.g=a.h.j;if(a.verify){a=(b[a.g++]<<24|b[a.g++]<<16|b[a.g++]<<8|b[a.g++])>>>0;b=c;if("string"===typeof b){b=[...b];f=0;for(h=b.length;f<h;f++)b[f]=(b[f].charPointAt(0)&255)>>>0;b=new Uint8Array([b])}f=\n1;h=0;k=b.length;for(l=0;0<k;){e=1024<k?1024:k;k-=e;do f+=b[l++],h+=f;while(--e);f%=65521;h%=65521}if(a!==(h<<16|f)>>>0)throw Error("invalid adler-32 checksum");}return c};const yc=({memory:a,messagePort:b,W:c})=>function(d,e,g,h){if(a){d=new Uint8Array(a.buffer,h,g);d=M.decode(d);var f=/\\n$/g.test(d);e=/^\\n/g.test(d);var k=d.split("\\n").filter(n=>0<n.length),l=[];if(0===k.length&&f||e)l.push(c.join("")),$b(c);k.forEach((n,q)=>{q+1===k.length?f?0===q?(l.push(c.join("")+n),$b(c)):l.push(n):c.push(n):0===q?(l.push(c.join("")+n),$b(c)):l.push(n)});l.forEach(n=>{n.replace(/(\\r\\n|\\n|\\r)/gm,"")&&b.G({log:n})})}},zc=a=>{if(a&&"object"===typeof a&&"object"===typeof a.exports){if(a.exports.__wasm_call_ctors){if(a.exports.csoundModuleCreate||\na.exports.csound_opcode_init||a.exports.csound_fgen_init)return!0;console.error(a.exports,"A csound plugin turns out to be neither a plugin, opcode or module.\\nPerhaps csdl.h or module.h wasn\'t imported correctly?");return!1}console.error("A csound plugin didn\'t export __wasm_call_ctors.\\nPlease re-run wasm-ld with either --export-all or include --export=__wasm_call_ctors");return!1}console.error("Error instantiating a csound plugin, instance and/or export is missing!");return!1},Ac=a=>{function b(){let l=\n0,n=1;for(;;){const q=a[c++];l+=(q&127)*n;n*=128;if(!(q&128))break}return l}1836278016!==(new Uint32Array((new Uint8Array(a.subarray(0,24))).buffer))[0]&&console.error("Wasm magic number is missing!");if(0!==a[8])return bc(),"static";let c=9;const d=b();c++;c++;c++;c++;c++;c++;c++;c++;c+=3;const e=b(),g=b(),h=b(),f=b(),k=b();return{Bb:d,D:e,S:g,wb:k,X:h,Cb:f}},Bc=async({Ta:a,i:b,messagePort:c})=>{const d=await WebAssembly.compile(a);a=new WebAssembly.Memory({initial:16384});const e=Vb(b,d);e.s=e.s||\n{};e.s.fb=()=>0;e.s.memory=a;e.s.hb=yc({memory:e.s.memory,W:[],messagePort:c});c=await WebAssembly.instantiate(d,e);b.memory=a;b.start(c);c.exports.__wasi_js_csoundSetMessageStringCallback();return[c,b]};\nasync function Cc({Ua:a,withPlugins:b=[],messagePort:c}){var d={};const e=new F;a=new Uint8Array(a);a=xc(new wc(a));var g=Ac(a);if("static"===g)return await Bc({messagePort:c,Ta:a,Fb:d,i:e});d=g.D;const h=g.S;g=g.X;b=await b.reduce(async(x,v)=>{x=await x;let H,D;try{H=new Uint8Array(v),D=Ac(H)}catch(G){console.error("Error in plugin",G)}D&&x.push({P:D,Va:H});return x},[]);d=Math.ceil((d+h)/65536);var f=Math.ceil(b.reduce((x,{P:v})=>"static"===v?0:x+(v.D+h),0)/65536);f=d+f+2048;const k=new WebAssembly.Memory({initial:f,\nmaximum:16384}),l=new WebAssembly.Table({initial:g+1,element:"anyfunc"});e.memory=k;const n=new WebAssembly.Global({value:"i32",mutable:!0},65536*f);g=new WebAssembly.Global({value:"i32",mutable:!0},65536*f);f=new WebAssembly.Global({value:"i32",mutable:!1},2048);const q=new WebAssembly.Global({value:"i32",mutable:!1},1),p=new WebAssembly.Global({value:"i32",mutable:!0},0);a=await WebAssembly.compile(a);const t=Vb(e,a);let y=[],L=d;t.env=t.env||{};t.env.memory=k;t.env.__indirect_function_table=l;\nt.env.__stack_pointer=n;t.env.__memory_base=f;t.env.__table_base=q;t.env.csoundLoadModules=x=>{y.forEach(v=>{if(void 0===A)console.error("csound-wasm internal: timing problem detected!");else{var H=A;if(v.exports.csoundModuleInit){var D=new WebAssembly.Global({value:"i32",mutable:!0},0),G=new WebAssembly.Global({value:"i32",mutable:!0},0),E=new WebAssembly.Global({value:"i32",mutable:!0},0);const P=new WebAssembly.Global({value:"i32",mutable:!0},0);let w=l.length;"function"===typeof v.exports.csoundModuleCreate&&\n(l.grow(1),D.value=w,l.set(w,v.exports.csoundModuleCreate),w+=1);"function"===typeof v.exports.csoundModuleInit&&(l.grow(1),G.value=w,l.set(w,v.exports.csoundModuleInit),w+=1);"function"===typeof v.exports.csoundModuleDestroy&&(l.grow(1),E.value=w,l.set(w,v.exports.csoundModuleDestroy),w+=1);"function"===typeof v.exports.csoundModuleErrorCodeToString&&(l.grow(1),P.value=w,l.set(w,v.exports.csoundModuleErrorCodeToString));H.exports.csoundWasiLoadPlugin(x,D,G,E,P)}else v.exports.csound_opcode_init||\nv.exports.csound_fgen_init?(D=new WebAssembly.Global({value:"i32",mutable:!0},0),G=new WebAssembly.Global({value:"i32",mutable:!0},0),E=l.length,"function"===typeof v.exports.csound_opcode_init&&(D.value=E,l.grow(1),l.set(E,v.exports.csound_opcode_init),E+=1),"function"===typeof v.exports.csound_fgen_init&&(G.value=E,l.grow(1),l.set(E,v.exports.csound_fgen_init)),H.exports.csoundWasiLoadOpcodeLibrary(x,G,D)):console.error("Plugin doesn\'t export nececcary functions to quality as csound plugin.")}});\nreturn 0};t.env.csoundLoadExternals=()=>{};t.env._ZTH5errno=function(){};t.env.csoundWasiJsMessageCallback=yc({memory:k,messagePort:c,W:[]});t.env.printDebugCallback=(x,v)=>{x=new Uint8Array(k.buffer,x,v);x=M.decode(x);console.log(x)};t["GOT.mem"]=t["GOT.mem"]||{};t["GOT.mem"].__heap_base=g;t["GOT.func"]=t["GOT.func"]||{};const A=await WebAssembly.instantiate(a,t);c=Object.assign({},A.exports);a={};c.memory=k;a.exports=c;y=await b.reduce(async(x,{P:v,Va:H})=>{x=await x;try{const D=v.D,G=v.S,E=v.X,\nP=await WebAssembly.compile(H),w=Vb(e,P),pa=new WebAssembly.Global({value:"i32",mutable:!1},65536*L);l.grow(E);w.env=Object.assign({},w.env);w.env.memory=k;w.env.__indirect_function_table=l;w.env.__memory_base=pa;w.env.__stack_pointer=n;w.env.__table_base=q;w.env.csoundLoadModules=p;delete w.env.csoundWasiJsMessageCallback;L+=Math.ceil((D+G)/65536);const B=await WebAssembly.instantiate(P,w);zc(B)&&(B.exports.__wasm_call_ctors(),x.push(B))}catch(D){console.error("Error while compiling csound-plugin",\nD)}return x},[]);e.start(a);a.exports.__wasi_js_csoundSetMessageStringCallback();return[a,e]};const Dc=(a,b,c,d)=>e=>{const g=e.csound,h=1===b.csoundShouldDaemonize(g);if(h){var f=b.csoundSetOption(g,"--daemon");0!==f&&console.error("csoundSetOption daemon failed:",f);f=b.csoundSetOption(g,"-odac");0!==f&&console.error("csoundSetOption odac failed:",f)}f=b.csoundStart(g);const k=b.csoundGetOutputName(g)||"test.wav";ac()();0!==f&&a.G(`error: csoundStart failed while trying to render ${k},`+" look out for errors in options and syntax");setTimeout(()=>{const l=b._isRequestingRtMidiInput(g);if(h||\nl||k.includes("dac"))c(e);else if(a.o("renderStarted"),d)d(e);else for(;0===b.csoundPerformKsmps(g););},0);return f};const Ec=[0,4096,0,0,0,0,-1,-1,-1,-1,0,128,0,0,0,0,0,0,0,0];let Fc,Gc,Hc;\nconst Ic=({C:a,B:b,J:c,H:d,I:e,Z:g,K:h})=>async f=>{var k=f.audioStreamIn,l=f.audioStreamOut;const n=f.midiBuffer,q=f.csound,p=new Int32Array(f.audioStateBuffer);Ec.forEach((Y,Ra)=>{Atomics.store(p,Ra,Y)});f=a._isRequestingRtMidiInput(q);var t=0===Atomics.load(p,9)&&a.csoundGetInputName(q).includes("adc"),y=Atomics.load(p,8),L=Atomics.load(p,9),A=Atomics.load(p,6);-1<y&&(y=a.csoundSetOption(q,"--nchnls="+y),0!==y&&console.error("csoundSetOption nchnls failed:",y));-1<L&&(y=a.csoundSetOption(q,"--nchnls_i="+\nL),0!==y&&console.error("csoundSetOption nchnls_i failed:",y));-1<A&&(A=a.csoundSetOption(q,"--sample-rate="+A),0!==A&&console.error("csoundSetOption sample-rate failed:",A));const x=a.csoundGetNchnls(q),v=L||t?a.csoundGetNchnlsInput(q):0,H=Atomics.load(p,6)||a.csoundGetSr(q);Atomics.store(p,8,x);Atomics.store(p,9,v);Atomics.store(p,10,t?1:0);Atomics.store(p,6,a.csoundGetSr(q));Atomics.store(p,16,f);t=a.csoundGetKsmps(q);Atomics.store(p,7,t);const D=a.csoundGet0dBFS(q);L=[];A=[];for(y=0;y<x;++y)L.push(new Float64Array(l,\n16384*y,16384));for(l=0;l<v;++l)A.push(new Float64Array(k,16384*l,16384));h.o("realtimePerformanceStarted");Atomics.store(p,2,1);V()();k=!0;let G=0,E=0,P=0,w=0,pa;l=(Y=!1)=>1===Atomics.load(p,5)||1!==Atomics.load(p,2)||0!==G||Y?(0===G&&V()(),V()(),h.o("realtimePerformanceEnded"),V()(),c(),!0):!1;for(y=!0;!y||(pa=Atomics.wait(p,0,1,1E4));){if("timed-out"===pa){l(!0);break}k&&(k=!1,await new Promise(z=>{Hc=z;h.L()}),V()());1===Atomics.load(p,4)&&(await new Promise(z=>setTimeout(z,0)),d(),await new Promise(z=>\nsetTimeout(z,0)),Atomics.wait(p,4,0),await new Promise(z=>setTimeout(z,0)),e(),await new Promise(z=>setTimeout(z,0)));if(l())break;if(f){var B=Atomics.load(p,18);if(0<B){var U=Atomics.load(p,17),O=U;for(let z=0;z<B;z++){O=(U+3*z)%1024;const ia=Atomics.load(n,O),Jc=Atomics.load(n,O+1),Kc=Atomics.load(n,O+2);a.csoundPushMidiMessage(q,ia,Jc,Kc)}Atomics.store(p,17,(O+1)%1024);Atomics.sub(p,18,B)}}const Y=Atomics.load(p,11);B=Atomics.load(p,14)>=Y;U=a.csoundGetSpin(q);O=a.csoundGetSpout(q);const Ra=B&&\nnew Float64Array(g.i.memory.buffer,U,t*v),Lc=new Float64Array(g.i.memory.buffer,O,t*x);U=Atomics.load(p,1);for(O=0;O<U;O++){if(0===E)if(0===G)G=a.csoundPerformKsmps(q),!y&&Atomics.add(p,15,t),y=!1;else if(0!==G){Atomics.store(p,2,0);l(!0);return}L.forEach((z,ia)=>{z[w]=(Lc[E*x+ia]||0)/D});B&&(A.forEach((z,ia)=>{Ra[E*v+ia]=(z[P]||0)*D}),P=B&&(P+1)%16384);w=(w+1)%16384;E=(E+1)%t}B&&Atomics.sub(p,14,U);1===Atomics.compareExchange(p,19,1,0)&&await new Promise(z=>{Gc=z;b()});if(l())break;B=Atomics.load(p,\n12);B=Math.max(2048-(w<B?w+16384-B:w-B),0);Atomics.store(p,1,B);0===B&&await new Promise(z=>setTimeout(z,Y/H*1E3))}},Mc=({port:a})=>{const b=new K;b.G=c=>{a.postMessage({log:c})};b.o=c=>{const d={};d.playStateChange=c;a.postMessage(d)};b.L=()=>{a.postMessage({Ab:"unlocked"})};b.g=!0;return b},Nc=a=>{const b=a.port;b.addEventListener("message",c=>{if(c.data&&c.data.unlock)c=Hc,Hc=void 0,c&&c();else{c=c.data;var d=c.reduce((e,g)=>{const h=g.id;var f=g.argumentz;g=g.apiKey;try{const k=Fc.get(g),l=k&&\nk.apply({},f||[]);f={};f.id=h;f.answer=l;e.push(f)}catch(k){throw Error(k);}return e},[]);b.postMessage(d);d=Gc;Gc=void 0;d&&d(c)}});b.start()},Oc=({C:a,B:b,J:c,H:d,I:e,K:g})=>async h=>{const f=h.csound;h=new Int32Array(h.audioStateBuffer);Atomics.store(h,3,1);for(g.L();1!==Atomics.load(h,5)&&0===a.csoundPerformKsmps(f);)1===Atomics.load(h,4)&&(d(),Atomics.wait(h,4,0),e()),1===Atomics.compareExchange(h,19,1,0)&&await new Promise(k=>{Gc=k;b()});Atomics.store(h,3,0);g.o("renderEnded");c()},Pc=async a=>\n{const b=a.wasmDataURI,c=a.withPlugins||[],d=a.messagePort,e=a.callbackPort;V()();const g=Mc({port:d}),h=()=>e.postMessage("poll"),f=()=>e.postMessage("releaseStop"),k=()=>e.postMessage("releasePause"),l=()=>e.postMessage("releaseResumed");Nc({port:e});const [n,q]=await Cc({Ua:b,withPlugins:c,messagePort:g});n.i=q;const p=Nb(n);Fc=new Map(Object.entries({...p,csoundStart:(t,y)=>Dc(g,p,Ic({C:p,B:h,Z:n,K:g,J:f,H:k,I:l}),Oc({C:p,B:h,K:g,i:q,J:f,H:k,I:l}))(y),Z:n}));p.csoundInitialize(0);return p.csoundCreate()};\nu("initialize$$module$src$workers$sab_worker",Pc);fa({initialize:Pc,callUncloned:async(a,b)=>(a=Fc.get(a))&&a.apply({},b||[])});}).call(this);\n//# sourceMappingURL=__compiled.sab.worker.js.map\n',
    ]),
  );
